<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub PAT Validity Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 20px;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        h1 { color: #cc3300; }
        .action-button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            margin-top: 15px;
            transition: background-color 0.3s;
        }
        .action-button:hover:not(:disabled) {
            background-color: #0056b3;
        }
        .action-button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        .status {
            padding: 10px;
            margin-top: 15px;
            border-radius: 4px;
            font-weight: bold;
        }
        .status-running { background-color: #fff3cd; color: #856404; }
        .status-complete { background-color: #d4edda; color: #155724; }
        .status-error { background-color: #f8d7da; color: #721c24; }
    </style>
</head>
<body>

<div class="container">
    <h1>GitHub PAT Validity Test</h1>
    <p>This script attempts a **simple read-only** API call to GitHub to check if your Personal Access Token is fundamentally valid and recognized by the server.</p>
    
    <button id="startButton" class="action-button" onclick="startDeployment()">
        ðŸ”‘ Test GitHub PAT
    </button>

    <div id="deployment-status" class="status status-running">
        Deployment Status: Ready to start PAT test.
    </div>

    <p><strong>Configuration Check:</strong> Ensure the PAT and REPO_OWNER variables in the script below are correct.</p>
</div>

<script>
    // --- CONFIGURATION ---
    const GITHUB_PAT = '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';
    const REPO_OWNER = 'Saadpie1'; 
    
    const STATUS_ELEMENT = document.getElementById('deployment-status');
    const START_BUTTON = document.getElementById('startButton');

    function updateStatus(message, isError = false) {
        STATUS_ELEMENT.textContent = `Deployment Status: ${message}`;
        STATUS_ELEMENT.className = 'status ' + (isError ? 'status-error' : 'status-running');
        if (!isError && message.includes('SUCCESS')) {
            STATUS_ELEMENT.className = 'status status-complete';
        }
        console.log(`[STATUS] ${message}`);
    }

    async function startDeployment() {
        START_BUTTON.disabled = true;
        START_BUTTON.textContent = 'Testing Token...';

        const testUrl = 'https://api.github.com/user';
        updateStatus('1/1: Attempting simple PAT validity test...');

        try {
            const testResponse = await fetch(testUrl, {
                method: 'GET',
                headers: {
                    'Accept': 'application/vnd.github.v3+json',
                    'Authorization': `Bearer ${GITHUB_PAT}`,
                },
            });

            if (testResponse.ok) {
                const userData = await testResponse.json();
                updateStatus(`SUCCESS! Token is valid for user: ${userData.login}. (Code 200/OK)`, false);
                console.log("User Data Received:", userData);
            } else {
                const errorBody = await testResponse.json();
                // If it fails here, it is a 401 or 403 error.
                throw new Error(`PAT Test FAILED (${testResponse.status}): ${errorBody.message || testResponse.statusText}`);
            }

        } catch (error) {
            updateStatus(`CRITICAL FAILURE: ${error.message}. The token is fundamentally invalid or has incorrect permissions.`, true);
        } finally {
            START_BUTTON.disabled = false;
            START_BUTTON.textContent = 'Rerun Token Test';
        }
    }

    window.onload = () => updateStatus("Ready to start PAT test.");
</script>
</body>
</html>
